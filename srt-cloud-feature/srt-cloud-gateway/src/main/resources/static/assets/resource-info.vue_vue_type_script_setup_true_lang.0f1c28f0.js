import{ad as i,d as $,h as f,K as P,an as L,X as I,r as d,o as p,f as b,w as t,b as o,c as v,e as _,F as D,G as C,a1 as K,l as U,E as M}from"./index.afa5927e.js";import{u as j}from"./role.e96c1f40.js";const G=a=>i.get("/data-assets/resource/"+a),H=a=>a.id?i.put("/data-assets/resource",a):i.post("/data-assets/resource",a),J=a=>i.put("/data-assets/resource/online/"+a),Q=a=>i.put("/data-assets/resource/offline/"+a),W=a=>i.delete("/data-assets/resource/"+a),O=U("\u53D6\u6D88"),S=U("\u786E\u5B9A"),Y=$({__name:"resource-info",emits:["refreshDataList"],setup(a,{expose:B,emit:R}){const F=f([]),E=f([]);P(()=>{j().then(s=>{F.value=s.data}),L().then(s=>{E.value=s.data})});const m=f(!1),c=f(),e=I({parentPath:"",catalogId:"",name:"",code:"",summary:"",openType:"",openRoles:[],openUsers:[],versionNo:"",dutyUser:"",dutyPhone:""}),w=(s,l,n)=>{m.value=!0,e.id="",c.value&&c.value.resetFields(),e.catalogId=l,e.parentPath=n,s&&h(s)},h=s=>{G(s).then(l=>{Object.assign(e,l.data)})},k=f({catalogId:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],name:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],code:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],openType:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],openRoles:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],openUsers:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],versionNo:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),V=()=>{c.value.validate(s=>{if(!s)return!1;e.openType==1?(e.openRoles=null,e.openUsers=null):e.openType==2?e.openUsers=null:e.openType==3&&(e.openRoles=null),H(e).then(()=>{M.success({message:"\u64CD\u4F5C\u6210\u529F",duration:500,onClose:()=>{m.value=!1,R("refreshDataList")}})})})};return B({init:w}),(s,l)=>{const n=d("el-input"),r=d("el-form-item"),T=d("fast-select"),g=d("el-option"),y=d("el-select"),x=d("el-form"),A=d("el-button"),N=d("el-dialog");return p(),b(N,{modelValue:m.value,"onUpdate:modelValue":l[12]||(l[12]=u=>m.value=u),title:e.id?"\u4FEE\u6539":"\u65B0\u589E","close-on-click-modal":!1},{footer:t(()=>[o(A,{onClick:l[10]||(l[10]=u=>m.value=!1)},{default:t(()=>[O]),_:1}),o(A,{type:"primary",onClick:l[11]||(l[11]=u=>V())},{default:t(()=>[S]),_:1})]),default:t(()=>[o(x,{ref_key:"dataFormRef",ref:c,model:e,rules:k.value,"label-width":"100px",onKeyup:l[9]||(l[9]=K(u=>V(),["enter"]))},{default:t(()=>[o(r,{label:"\u6240\u5C5E\u76EE\u5F55",prop:"parentPath","label-width":"auto"},{default:t(()=>[o(n,{modelValue:e.parentPath,"onUpdate:modelValue":l[0]||(l[0]=u=>e.parentPath=u),placeholder:"\u6240\u5C5E\u76EE\u5F55",disabled:""},null,8,["modelValue"])]),_:1}),o(r,{label:"\u540D\u79F0",prop:"name","label-width":"auto"},{default:t(()=>[o(n,{modelValue:e.name,"onUpdate:modelValue":l[1]||(l[1]=u=>e.name=u),placeholder:"\u540D\u79F0"},null,8,["modelValue"])]),_:1}),o(r,{label:"\u7F16\u7801",prop:"code","label-width":"auto"},{default:t(()=>[o(n,{modelValue:e.code,"onUpdate:modelValue":l[2]||(l[2]=u=>e.code=u),placeholder:"\u7F16\u7801"},null,8,["modelValue"])]),_:1}),o(r,{label:"\u7248\u672C\u53F7",prop:"versionNo","label-width":"auto"},{default:t(()=>[o(n,{modelValue:e.versionNo,"onUpdate:modelValue":l[3]||(l[3]=u=>e.versionNo=u),placeholder:"\u7248\u672C\u53F7"},null,8,["modelValue"])]),_:1}),o(r,{label:"\u5F00\u653E\u7C7B\u578B",prop:"openType","label-width":"auto"},{default:t(()=>[o(T,{modelValue:e.openType,"onUpdate:modelValue":l[4]||(l[4]=u=>e.openType=u),"dict-type":"open_type",placeholder:"\u5F00\u653E\u7C7B\u578B",clearable:""},null,8,["modelValue"])]),_:1}),e.openType==2?(p(),b(r,{key:0,label:"\u5F00\u653E\u89D2\u8272",prop:"openRoles","label-width":"auto"},{default:t(()=>[o(y,{modelValue:e.openRoles,"onUpdate:modelValue":l[5]||(l[5]=u=>e.openRoles=u),multiple:"",clearable:"",filterable:"",placeholder:"\u8BF7\u9009\u62E9"},{default:t(()=>[(p(!0),v(D,null,_(F.value,(u,q)=>(p(),b(g,{key:u.id,label:`[${u.id}]${u.name}`,value:u.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):C("",!0),e.openType==3?(p(),b(r,{key:1,label:"\u5F00\u653E\u7528\u6237",prop:"openUsers","label-width":"auto"},{default:t(()=>[o(y,{modelValue:e.openUsers,"onUpdate:modelValue":l[6]||(l[6]=u=>e.openUsers=u),multiple:"",clearable:"",filterable:"",placeholder:"\u8BF7\u9009\u62E9"},{default:t(()=>[(p(!0),v(D,null,_(E.value,(u,q)=>(p(),b(g,{key:u.id,label:`[${u.id}]${u.username}`,value:u.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):C("",!0),o(r,{label:"\u8D1F\u8D23\u4EBA",prop:"dutyUser","label-width":"auto"},{default:t(()=>[o(n,{modelValue:e.dutyUser,"onUpdate:modelValue":l[7]||(l[7]=u=>e.dutyUser=u),placeholder:"\u8D1F\u8D23\u4EBA"},null,8,["modelValue"])]),_:1}),o(r,{label:"\u6458\u8981",prop:"summary","label-width":"auto"},{default:t(()=>[o(n,{type:"textarea",modelValue:e.summary,"onUpdate:modelValue":l[8]||(l[8]=u=>e.summary=u),placeholder:"\u7F16\u7801"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}});export{Y as _,Q as a,W as d,J as o};
