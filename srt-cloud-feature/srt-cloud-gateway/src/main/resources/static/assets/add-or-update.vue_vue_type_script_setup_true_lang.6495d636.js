import{d as h,h as i,X as x,r,o as m,f,w as a,b as t,G as q,a1 as w,l as A,al as c,E as P}from"./index.afa5927e.js";import{u as V,a as L}from"./catalog.b61e02ab.js";const R=A("\u53D6\u6D88"),$=A("\u786E\u5B9A"),G=h({__name:"add-or-update",emits:["refreshDataList"],setup(K,{expose:v,emit:C}){const s=i(!1),p=i(),_=i([]),l=x({orgId:"",parentId:"",parentPath:"",path:"",name:"",code:"",type:0,orderNo:0,description:""}),y=(d,e,g)=>{s.value=!0,l.id="",p.value&&p.value.resetFields(),l.parentId=e,l.parentPath=g,e?V(e).then(o=>{o.data&&c(o.data.orgId).then(n=>{_.value=n.data})}):c().then(o=>{_.value=o.data}),d&&D(d)},D=d=>{V(d).then(e=>{Object.assign(l,e.data)})},B=i({orgId:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],name:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],code:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],type:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],orderNo:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),F=()=>{p.value.validate(d=>{if(!d)return!1;l.type=l.parentId==0?0:l.type,L(l).then(()=>{P.success({message:"\u64CD\u4F5C\u6210\u529F",duration:500,onClose:()=>{s.value=!1,C("refreshDataList")}})})})};return v({init:y}),(d,e)=>{const g=r("el-tree-select"),o=r("el-form-item"),n=r("el-input"),E=r("el-option"),k=r("el-select"),I=r("el-input-number"),N=r("el-form"),b=r("el-button"),U=r("el-dialog");return m(),f(U,{modelValue:s.value,"onUpdate:modelValue":e[10]||(e[10]=u=>s.value=u),title:l.id?"\u4FEE\u6539":"\u65B0\u589E","close-on-click-modal":!1},{footer:a(()=>[t(b,{onClick:e[8]||(e[8]=u=>s.value=!1)},{default:a(()=>[R]),_:1}),t(b,{type:"primary",onClick:e[9]||(e[9]=u=>F())},{default:a(()=>[$]),_:1})]),default:a(()=>[t(N,{ref_key:"dataFormRef",ref:p,model:l,rules:B.value,"label-width":"100px",onKeyup:e[7]||(e[7]=w(u=>F(),["enter"]))},{default:a(()=>[t(o,{prop:"orgId",label:"\u6240\u5C5E\u673A\u6784"},{default:a(()=>[t(g,{clearable:"",modelValue:l.orgId,"onUpdate:modelValue":e[0]||(e[0]=u=>l.orgId=u),data:_.value,"check-strictly":"","value-key":"id",props:{label:"name",children:"children"},style:{width:"100%"}},null,8,["modelValue","data"])]),_:1}),t(o,{label:"\u7236\u7EA7\u76EE\u5F55",prop:"parentPath"},{default:a(()=>[t(n,{disabled:"",modelValue:l.parentPath,"onUpdate:modelValue":e[1]||(e[1]=u=>l.parentPath=u),placeholder:""},null,8,["modelValue"])]),_:1}),t(o,{label:"\u540D\u79F0",prop:"name"},{default:a(()=>[t(n,{modelValue:l.name,"onUpdate:modelValue":e[2]||(e[2]=u=>l.name=u),placeholder:"\u540D\u79F0"},null,8,["modelValue"])]),_:1}),t(o,{label:"\u76EE\u5F55\u7F16\u7801",prop:"code"},{default:a(()=>[t(n,{modelValue:l.code,"onUpdate:modelValue":e[3]||(e[3]=u=>l.code=u),placeholder:"\u540D\u79F0"},null,8,["modelValue"])]),_:1}),l.parentId!=0?(m(),f(o,{key:0,label:"\u7C7B\u578B",prop:"type"},{default:a(()=>[t(k,{modelValue:l.type,"onUpdate:modelValue":e[4]||(e[4]=u=>l.type=u),placeholder:"\u7C7B\u578B",disabled:!!l.id},{default:a(()=>[(m(),f(E,{key:0,label:"\u666E\u901A\u76EE\u5F55",value:0})),(m(),f(E,{key:1,label:"\u8D44\u4EA7\u76EE\u5F55",value:1}))]),_:1},8,["modelValue","disabled"])]),_:1})):q("",!0),t(o,{label:"\u5E8F\u53F7",prop:"orderNo"},{default:a(()=>[t(I,{modelValue:l.orderNo,"onUpdate:modelValue":e[5]||(e[5]=u=>l.orderNo=u),max:9999,placeholder:"\u5E8F\u53F7"},null,8,["modelValue"])]),_:1}),t(o,{label:"\u63CF\u8FF0",prop:"description"},{default:a(()=>[t(n,{type:"textarea",modelValue:l.description,"onUpdate:modelValue":e[6]||(e[6]=u=>l.description=u)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}});export{G as _};
