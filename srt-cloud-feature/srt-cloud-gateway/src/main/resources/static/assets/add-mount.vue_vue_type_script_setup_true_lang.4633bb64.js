import{d as X,K as z,h as n,X as J,a5 as x,r as f,o as l,f as k,w as r,b as d,a as m,c as i,G as s,t as h,a1 as Q,l as P,E as F}from"./index.afa5927e.js";import{f as V}from"./folder.ea536bf2.js";import{_ as W}from"./database.235d7a89.js";import{_ as Y}from"./table.e1c1b00a.js";import{_ as Z}from"./column.79595943.js";import{_ as ee}from"./model.45425835.js";import{a as te}from"./api.55cd055b.js";import{_ as oe}from"./file.2b66c011.js";import{u as ue,a as ae}from"./resourceMount.b8c1bb2a.js";import{l as le}from"./metadata.ec7a05f4.js";import{u as se}from"./apiGroup.3f0ca4aa.js";import{l as ne}from"./fileCategory.95c3a650.js";import{_ as re}from"./api-mount.vue_vue_type_script_setup_true_name_Data-serviceApi-configIndex_lang.ca051d12.js";import{_ as ie}from"./file-mount.vue_vue_type_script_setup_true_name_Data-integrateFileIndex_lang.1db23114.js";const de={key:0,src:V},me={key:1,src:W},pe={key:2,src:Y},fe={key:3,src:Z},ce={key:4,src:ee},_e={style:{"margin-left":"8px"}},ye={key:0,src:V},ve={key:1,src:te},ge={style:{"margin-left":"8px"}},be={key:0,src:V},ke={key:1,src:oe},he={style:{"margin-left":"8px"}},Ce={key:0},Ie={key:1},Ee=P("\u53D6\u6D88"),Fe=P("\u786E\u5B9A"),Ke=X({__name:"add-mount",emits:["refreshDataList"],setup(Ve,{expose:$,emit:L}){z(()=>{le().then(o=>{D.value=o.data}),se().then(o=>{T.value=o.data}),ne().then(o=>{B.value=o.data})});const c=n(!1),v=n(),D=n([]),T=n([]),B=n([]),C={label:"name",children:"children",isLeaf:"leaf",disabled:"disabled"},t=J({mountType:"",treeId:"",mountId:"",mountName:""}),U=(o,e)=>{c.value=!0,t.id="",v.value&&v.value.resetFields(),t.resourceId=e,g.value=!1,o&&S(o)},S=o=>{ue(o).then(e=>{Object.assign(t,e.data)})},K=n({mountType:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],treeId:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),g=n(!1),M=n(),_=n();x("apiMountInfo",_);const q=(o,e,b,p)=>{console.log(e.data),e.data.type=="2"?(g.value=!0,setTimeout(()=>{M.value.init(e.data.id,e.data.path)},500)):g.value=!1},I=n(!1),w=n(),y=n();x("fileMountInfo",y);const G=(o,e,b,p)=>{console.log(e.data),e.data.type=="1"?(I.value=!0,setTimeout(()=>{w.value.init(e.data.id,e.data.path)},500)):I.value=!1},A=n(),j=(o,e,b,p)=>{console.log(e.data),e.data.disabled||(A.value=e.data)},N=()=>{v.value.validate(o=>{if(!o)return!1;if(t.mountType==1)t.mountId=t.treeId,t.mountName=A.value.path;else if(t.mountType==2)if(_.value)t.mountId=_.value.id,t.mountName=_.value.parentPath+"/"+_.value.name;else return F.warning("\u8BF7\u5355\u51FB\u5217\u8868\u9879\u9009\u62E9\u8981\u6302\u8F7D\u7684api"),!1;else if(t.mountType==3)if(y.value)t.mountId=y.value.id,t.mountName=y.value.parentPath+"/"+y.value.name;else return F.warning("\u8BF7\u5355\u51FB\u5217\u8868\u9879\u9009\u62E9\u8981\u6302\u8F7D\u7684\u6587\u4EF6"),!1;ae(t).then(()=>{F.success({message:"\u64CD\u4F5C\u6210\u529F",duration:500,onClose:()=>{c.value=!1,L("refreshDataList")}})})})};return $({init:U}),(o,e)=>{const b=f("fast-select"),p=f("el-form-item"),E=f("el-tree-select"),H=f("el-form"),R=f("el-button"),O=f("el-dialog");return l(),k(O,{modelValue:c.value,"onUpdate:modelValue":e[7]||(e[7]=u=>c.value=u),title:t.id?"\u4FEE\u6539":"\u6302\u8F7D\u8D44\u6E90","close-on-click-modal":!1,width:"70%"},{footer:r(()=>[d(R,{onClick:e[5]||(e[5]=u=>c.value=!1)},{default:r(()=>[Ee]),_:1}),d(R,{type:"primary",onClick:e[6]||(e[6]=u=>N())},{default:r(()=>[Fe]),_:1})]),default:r(()=>[d(H,{ref_key:"dataFormRef",ref:v,model:t,rules:K.value,"label-width":"100px",onKeyup:e[4]||(e[4]=Q(u=>N(),["enter"]))},{default:r(()=>[d(p,{label:"\u8D44\u6E90\u7C7B\u578B",prop:"mountType","label-width":"auto"},{default:r(()=>[d(b,{modelValue:t.mountType,"onUpdate:modelValue":e[0]||(e[0]=u=>t.mountType=u),"dict-type":"mount_type",placeholder:"\u8D44\u6E90\u7C7B\u578B",clearable:""},null,8,["modelValue"])]),_:1}),t.mountType==1?(l(),k(p,{key:0,label:"\u9009\u62E9\u5E93\u8868",prop:"treeId","label-width":"auto"},{default:r(()=>[d(E,{"check-strictly":"",modelValue:t.treeId,"onUpdate:modelValue":e[1]||(e[1]=u=>t.treeId=u),props:C,data:D.value,filterable:"",clearable:"",onNodeClick:j},{default:r(({node:u,data:a})=>[m("div",null,[m("span",null,[a.icon=="/src/assets/folder.png"?(l(),i("img",de)):s("",!0),a.icon=="/src/assets/database.png"?(l(),i("img",me)):s("",!0),a.icon=="/src/assets/table.png"?(l(),i("img",pe)):s("",!0),a.icon=="/src/assets/column.png"?(l(),i("img",fe)):s("",!0),a.icon=="/src/assets/model.png"?(l(),i("img",ce)):s("",!0),m("span",_e,h(a.name)+"\u2003"+h(a.code),1)])])]),_:1},8,["modelValue","data"])]),_:1})):s("",!0),t.mountType==2?(l(),k(p,{key:1,label:"\u9009\u62E9api",prop:"treeId","label-width":"auto"},{default:r(()=>[d(E,{modelValue:t.treeId,"onUpdate:modelValue":e[2]||(e[2]=u=>t.treeId=u),props:C,data:T.value,filterable:"",clearable:"",onNodeClick:q},{default:r(({node:u,data:a})=>[m("div",null,[m("span",null,[a.type=="1"?(l(),i("img",ye)):s("",!0),a.type=="2"?(l(),i("img",ve)):s("",!0),m("span",ge,h(a.name),1)])])]),_:1},8,["modelValue","data"])]),_:1})):s("",!0),t.mountType==3?(l(),k(p,{key:2,label:"\u9009\u62E9\u6587\u4EF6",prop:"treeId","label-width":"auto"},{default:r(()=>[d(E,{modelValue:t.treeId,"onUpdate:modelValue":e[3]||(e[3]=u=>t.treeId=u),props:C,data:B.value,filterable:"",clearable:"",onNodeClick:G},{default:r(({node:u,data:a})=>[m("div",null,[m("span",null,[a.type=="0"?(l(),i("img",be)):s("",!0),a.type=="1"?(l(),i("img",ke)):s("",!0),m("span",he,h(a.name),1)])])]),_:1},8,["modelValue","data"])]),_:1})):s("",!0)]),_:1},8,["model","rules"]),t.mountType==2&&g.value?(l(),i("div",Ce,[d(re,{ref_key:"apiMountRef",ref:M},null,512)])):s("",!0),t.mountType==3&&I.value?(l(),i("div",Ie,[d(ie,{ref_key:"fileMountRef",ref:w},null,512)])):s("",!0)]),_:1},8,["modelValue","title"])}}});export{Ke as _};
