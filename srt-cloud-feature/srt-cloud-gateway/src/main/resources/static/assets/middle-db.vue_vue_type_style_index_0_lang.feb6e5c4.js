import{d as ee,aa as r,h as d,O as te,X as le,r as n,o as q,c as oe,b as t,w as o,a as s,k as D,ab as ae,a6 as v,a7 as E,t as f,l as _,f as ne,G as se,v as ie}from"./index.afa5927e.js";import{a as ue,b as re}from"./database.e836db09.js";import{_ as de}from"./database.235d7a89.js";import{_ as ce}from"./table.e1c1b00a.js";import{h as pe}from"./house.1ac0c09f.js";import{_ as O}from"./readonly-studio.vue_vue_type_script_setup_true_lang.c5082512.js";const _e=s("br",null,null,-1),be=s("br",null,null,-1),me={class:"custom-tree-node"},fe=["src"],he=["src"],ge=["src"],Ce={style:{"margin-left":"8px"}},De=_("******"),ve=_("******"),Ee={class:"custom-tabs-label"},xe=s("span",null,"\u5B57\u6BB5\u4FE1\u606F",-1),ye={class:"custom-tabs-label"},Se=s("span",null,"SQL \u751F\u6210",-1),Le=_("\u67E5\u770B"),Ve=_("\u65B0\u5EFA\u67E5\u8BE2"),Ae=ee({__name:"middle-db",emits:["setCodeText"],setup(Te,{expose:X,emit:T}){const x=r("editorValues"),k=r("editableTabsValue"),B=r("editableTabs");r("consoleLogRef"),r("consoleResultRef"),r("hasMiddledb");const h=r("filterNodeText"),w=d(),y=d(!1),S=d(!1),g=d({}),F=d([]),N=d(),R=d();te(h,l=>{w.value.filter(l)});const A=d([]),a=le({optionCardShow:!1,optionCardX:0,optionCardY:0,optionData:{},node:"",tree:""}),j=(l,e)=>{A.value=e},M=(l,e)=>l?e.label.includes(l)||e.label.includes(l.toUpperCase())||e.label.includes(l.toLowerCase())||e.description&&e.description.includes(l)||e.description&&e.description.includes(l.toUpperCase())||e.description&&e.description.includes(l.toLowerCase()):!0,Y=()=>{let l=a.optionData;console.log(l),L(),l.ifLeaf?(g.value=l.attributes,y.value=!0):(S.value=!0,ue(l.label).then(e=>{F.value=e.data}),re(l.label,l.description).then(e=>{N.value.setEditorValue(e.data.sqlCreate),R.value.setEditorValue(e.data.sqlSelect)}))},G=()=>{P(a.optionData)},$=r("currentNodeData"),P=l=>{$.value=l;let e=l.code;console.log(e);const b=B.value;let c=!1;for(let V in b){let u=b[V];if(u.name==e){c=!0,u.title=l.name;break}}c?(k.value=e,T("setCodeText")):(B.value.push({title:l.name,name:e}),k.value=e,T("setCodeText")),c||(x[e]={},x[e].codeText=""),x[e].nodeData=l},H=(l,e,b,c)=>{a.optionCardShow=!1,a.optionCardX=l.x,a.optionCardY=l.y,a.optionData=e,a.node=b,a.tree=c,e.type!="2"&&(a.optionCardShow=!0)},L=l=>{var e=document.getElementById("option-button-group");e&&(a.optionCardShow=!1)};return X({init:j,OptionCardClose:L}),(l,e)=>{const b=n("el-input"),c=n("el-tree"),V=n("el-scrollbar"),u=n("el-descriptions-item"),J=n("el-descriptions"),Q=n("el-dialog"),K=n("Document"),U=n("el-icon"),i=n("el-table-column"),W=n("el-table"),C=n("el-tab-pane"),Z=n("DataLine"),z=n("el-tabs"),I=n("el-button");return q(),oe("div",null,[t(V,null,{default:o(()=>[s("div",{class:"databases",onClick:e[1]||(e[1]=p=>L())},[t(b,{modelValue:D(h),"onUpdate:modelValue":e[0]||(e[0]=p=>ae(h)?h.value=p:null),placeholder:"search"},null,8,["modelValue"]),_e,be,t(c,{ref_key:"databaseTreeRef",ref:w,data:A.value,"default-expand-all":"",onNodeContextmenu:H,"node-key":"id","filter-node-method":M},{default:o(({node:p,data:m})=>[s("span",me,[v(s("img",{src:D(pe)},null,8,fe),[[E,m.type=="1"]]),v(s("img",{src:D(de)},null,8,he),[[E,m.type=="2"]]),v(s("img",{src:D(ce)},null,8,ge),[[E,m.type=="3"]]),s("span",Ce,f(m.label)+"\u2003"+f(m.description),1)])]),_:1},8,["data"])])]),_:1}),t(Q,{modelValue:y.value,"onUpdate:modelValue":e[2]||(e[2]=p=>y.value=p),title:"\u8BE6\u60C5"},{default:o(()=>[t(J,{size:"default",column:1,"label-class-name":"el-descriptions-item-label-class",border:""},{default:o(()=>[t(u,{label:"\u540D\u79F0"},{default:o(()=>[_(f(g.value.name),1)]),_:1}),t(u,{label:"\u5E93\u540D"},{default:o(()=>[_(f(g.value.databaseName),1)]),_:1}),t(u,{label:"\u7528\u6237\u540D"},{default:o(()=>[De]),_:1}),t(u,{label:"\u5BC6\u7801"},{default:o(()=>[ve]),_:1}),t(u,{label:"jdbc\u8FDE\u63A5\u4E32"},{default:o(()=>[_(f(g.value.jdbcUrl),1)]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Q,{modelValue:S.value,"onUpdate:modelValue":e[3]||(e[3]=p=>S.value=p),title:"\u8BE6\u60C5",width:"65%"},{default:o(()=>[t(z,{class:"table-tabs"},{default:o(()=>[t(C,null,{label:o(()=>[s("span",Ee,[t(U,null,{default:o(()=>[t(K)]),_:1}),xe])]),default:o(()=>[t(W,{data:F.value,height:"500",style:{width:"100%"}},{default:o(()=>[t(i,{prop:"fieldName",label:"\u540D\u79F0","header-align":"center",align:"center"}),t(i,{prop:"remarks",label:"\u6CE8\u91CA","header-align":"center",align:"center"}),t(i,{prop:"fieldTypeName",label:"\u7C7B\u578B","header-align":"center",align:"center"}),t(i,{prop:"displaySize",label:"\u957F\u5EA6","header-align":"center",align:"center"}),t(i,{prop:"scaleSize",label:"\u5C0F\u6570\u4F4D\u6570","header-align":"center",align:"center"}),t(i,{prop:"defaultValue",label:"\u9ED8\u8BA4\u503C","header-align":"center",align:"center"}),t(i,{prop:"pk",label:"\u662F\u5426\u4E3B\u952E","header-align":"center",align:"center"}),t(i,{prop:"autoIncrement",label:"\u662F\u5426\u9012\u589E","header-align":"center",align:"center"}),t(i,{prop:"nullable",label:"\u662F\u5426\u53EF\u4E3A\u7A7A","header-align":"center",align:"center"})]),_:1},8,["data"])]),_:1}),t(C,null,{label:o(()=>[s("span",ye,[t(U,null,{default:o(()=>[t(Z)]),_:1}),Se])]),default:o(()=>[t(z,{"tab-position":"left",style:{height:"500px"},class:"sql-tabs"},{default:o(()=>[t(C,{label:"SQL DDL"},{default:o(()=>[t(O,{id:"middleSQLDDL",ref_key:"SQLDDLRef",ref:N,style:{height:"500px"}},null,512)]),_:1}),t(C,{label:"SQL SELECT"},{default:o(()=>[t(O,{id:"middleSQLSELECT",ref_key:"SQLSELECTRef",ref:R,style:{height:"500px"}},null,512)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),v(s("div",{style:ie({"z-index":9999,position:"fixed",left:a.optionCardX+"px",top:a.optionCardY+"px",width:"100px",background:"white","box-shadow":"0 2px 4px rgba(0, 0, 0, .12), 0 0 6px rgba(0, 0, 0, .04)"}),id:"option-button-group"},[t(I,{onClick:Y,class:"option-card-button"},{default:o(()=>[Le]),_:1}),a.optionData.type==1?(q(),ne(I,{key:0,onClick:G,class:"option-card-button"},{default:o(()=>[Ve]),_:1})):se("",!0)],4),[[E,a.optionCardShow]])])}}});export{Ae as _};
