import{d as A,X,h as D,i as G,ai as J,r as u,aj as k,o as p,f as c,w as o,a as _,b as e,k as s,a6 as y,a1 as Q,c as W,e as Y,F as Z,l as m,E as x}from"./index.afa5927e.js";import{_ as ee}from"./add-or-update.vue_vue_type_script_setup_true_lang.0e6432a4.js";import{t as ae,j as te,m as le}from"./database.e836db09.js";const oe={class:"databaseDivClass"},ne=m("\u67E5\u8BE2"),ue=m("\u65B0\u589E"),re=m("\u5220\u9664"),se=m("\u7F16\u8F91"),de=m("\u5E93\u8868"),ie=m("\u6D4B\u8BD5"),pe=m("\u5220\u9664"),me={class:"drawerClass",style:{height:"100%"}},ce={class:"tableMain"},_e={style:{"margin-top":"10px"}},ge={style:{"margin-top":"10px"}},be=m("\u6267\u884Csql"),fe=_("br",null,null,-1),he=_("p",{style:{"margin-left":"50px","margin-top":"20px"}},"\u82E5\u8D85\u8FC7100\u6761\uFF0C\u53EA\u663E\u793A\u524D100\u6761\u6570\u636E\uFF01",-1),ye=A({name:"Data-integrateDatabaseIndex"}),Fe=A({...ye,setup(Ce){const a=X({dataListUrl:"/data-integrate/database/page",deleteUrl:"/data-integrate/database",queryForm:{name:"",databaseType:"",databaseName:"",databaseSchema:"",status:"",isRtApprove:"",projectId:""},drawer:!1,direction:"rtl",databaseId:"",sqlDataHeader:{},sqlData:[],tableData:[]}),F=D(),E=n=>{F.value.init(n)},U=n=>{ae(n).then(()=>{x.success({message:"\u6D4B\u8BD5\u8FDE\u63A5\u6210\u529F",duration:500,onClose:()=>{C()}})})},L=n=>{a.drawer=!0,a.databaseId=n,te(n).then(t=>{a.tableData=t.data})},f=D(""),z=()=>{if(!f.value.trim()){x.error("\u8BF7\u8F93\u5165sql");return}le(a.databaseId,{sql:f.value}).then(n=>{a.sqlDataHeader=n.data.columns,a.sqlData=n.data.rows})},g=D(""),S=G(()=>a.tableData.filter(n=>!g.value||n.tableName&&n.tableName.toLowerCase().includes(g.value.toLowerCase())||n.remarks&&n.remarks.toLowerCase().includes(g.value.toLowerCase()))),N=n=>{g.value="",f.value="",a.sqlData=[],a.sqlDataHeader=[],a.tableData=[],n()},{getDataList:C,selectionChangeHandle:$,sizeChangeHandle:H,currentChangeHandle:T,deleteBatchHandle:q}=J(a);return(n,t)=>{const h=u("el-input"),d=u("el-form-item"),V=u("fast-select"),i=u("el-button"),I=u("el-form"),r=u("el-table-column"),B=u("fast-table-column"),R=u("fast-table-org-column"),j=u("fast-creator-column"),w=u("el-table"),O=u("el-pagination"),K=u("el-drawer"),M=u("el-card"),v=k("auth"),P=k("loading");return p(),c(M,null,{default:o(()=>[_("div",oe,[e(I,{inline:!0,model:a.queryForm,onKeyup:t[8]||(t[8]=Q(l=>s(C)(),["enter"]))},{default:o(()=>[e(d,null,{default:o(()=>[e(h,{modelValue:a.queryForm.name,"onUpdate:modelValue":t[0]||(t[0]=l=>a.queryForm.name=l),placeholder:"\u540D\u79F0"},null,8,["modelValue"])]),_:1}),e(d,null,{default:o(()=>[e(V,{modelValue:a.queryForm.databaseType,"onUpdate:modelValue":t[1]||(t[1]=l=>a.queryForm.databaseType=l),"dict-type":"database_type",placeholder:"\u6570\u636E\u5E93\u7C7B\u578B",clearable:""},null,8,["modelValue"])]),_:1}),e(d,null,{default:o(()=>[e(h,{modelValue:a.queryForm.databaseName,"onUpdate:modelValue":t[2]||(t[2]=l=>a.queryForm.databaseName=l),placeholder:"\u5E93\u540D(\u670D\u52A1\u540D)"},null,8,["modelValue"])]),_:1}),e(d,null,{default:o(()=>[e(h,{modelValue:a.queryForm.databaseSchema,"onUpdate:modelValue":t[3]||(t[3]=l=>a.queryForm.databaseSchema=l),placeholder:"schema"},null,8,["modelValue"])]),_:1}),e(d,null,{default:o(()=>[e(V,{modelValue:a.queryForm.status,"onUpdate:modelValue":t[4]||(t[4]=l=>a.queryForm.status=l),"dict-type":"database_status",placeholder:"\u72B6\u6001",clearable:""},null,8,["modelValue"])]),_:1}),e(d,null,{default:o(()=>[e(i,{onClick:t[5]||(t[5]=l=>s(C)())},{default:o(()=>[ne]),_:1})]),_:1}),e(d,null,{default:o(()=>[y((p(),c(i,{type:"primary",onClick:t[6]||(t[6]=l=>E())},{default:o(()=>[ue]),_:1})),[[v,"data-integrate:database:save"]])]),_:1}),e(d,null,{default:o(()=>[y((p(),c(i,{type:"danger",onClick:t[7]||(t[7]=l=>s(q)())},{default:o(()=>[re]),_:1})),[[v,"data-integrate:database:delete"]])]),_:1})]),_:1},8,["model"]),y((p(),c(w,{data:a.dataList,border:"",style:{width:"100%"},"max-height":"calc(100vh - 400px )",onSelectionChange:s($)},{default:o(()=>[e(r,{type:"selection","header-align":"center",align:"center",width:"50"}),e(r,{prop:"name",label:"\u540D\u79F0","header-align":"center",align:"center","show-overflow-tooltip":""}),e(B,{prop:"databaseType",label:"\u6570\u636E\u5E93\u7C7B\u578B","dict-type":"database_type"}),e(r,{prop:"databaseIp",label:"\u4E3B\u673Aip","header-align":"center",align:"center","show-overflow-tooltip":""}),e(r,{prop:"databasePort",label:"\u7AEF\u53E3","header-align":"center",align:"center"}),e(r,{prop:"databaseName",label:"\u5E93\u540D(\u670D\u52A1\u540D)","header-align":"center",align:"center","show-overflow-tooltip":""}),e(r,{prop:"databaseSchema",label:"schema","header-align":"center",align:"center","show-overflow-tooltip":""}),e(B,{prop:"status",label:"\u72B6\u6001","dict-type":"database_status"}),e(R,{prop:"orgId",label:"\u6240\u5C5E\u673A\u6784","header-align":"center",align:"center"}),e(j,{prop:"creator",label:"\u521B\u5EFA\u8005","header-align":"center",align:"center"}),e(r,{prop:"createTime",label:"\u521B\u5EFA\u65F6\u95F4","header-align":"center",align:"center",width:"160","show-overflow-tooltip":""}),e(r,{label:"\u64CD\u4F5C",fixed:"right","header-align":"center",align:"center",width:"200"},{default:o(l=>[y((p(),c(i,{type:"primary",link:"",onClick:b=>E(l.row.id)},{default:o(()=>[se]),_:2},1032,["onClick"])),[[v,"data-integrate:database:update"]]),e(i,{type:"primary",link:"",onClick:b=>L(l.row.id)},{default:o(()=>[de]),_:2},1032,["onClick"]),e(i,{type:"primary",link:"",onClick:b=>U(l.row)},{default:o(()=>[ie]),_:2},1032,["onClick"]),y((p(),c(i,{type:"danger",link:"",onClick:b=>s(q)(l.row.id)},{default:o(()=>[pe]),_:2},1032,["onClick"])),[[v,"data-integrate:database:delete"]])]),_:1})]),_:1},8,["data","onSelectionChange"])),[[P,a.dataListLoading]]),e(O,{"current-page":a.page,"page-sizes":a.pageSizes,"page-size":a.limit,total:a.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:s(H),onCurrentChange:s(T)},null,8,["current-page","page-sizes","page-size","total","onSizeChange","onCurrentChange"]),_("div",me,[e(K,{modelValue:a.drawer,"onUpdate:modelValue":t[12]||(t[12]=l=>a.drawer=l),title:"\u67E5\u770B\u5E93\u8868",size:"100%","before-close":N,direction:a.direction},{default:o(()=>[_("div",ce,[_("div",_e,[e(h,{modelValue:g.value,"onUpdate:modelValue":t[9]||(t[9]=l=>g.value=l),size:"large",placeholder:"\u8F93\u5165\u8868\u540D\u6216\u6CE8\u91CA"},null,8,["modelValue"]),e(w,{data:s(S),style:{width:"100%"}},{default:o(()=>[e(r,{label:"\u5E8F\u53F7",type:"index",width:"60"}),e(r,{label:"\u540D\u79F0",prop:"tableName"}),e(r,{label:"\u6CE8\u91CA",prop:"remarks"})]),_:1},8,["data"])]),_("div",ge,[e(i,{type:"primary",round:"",style:{"margin-left":"50px"},onClick:t[10]||(t[10]=l=>z())},{default:o(()=>[be]),_:1}),fe,e(h,{style:{"margin-left":"50px","margin-top":"20px",width:"80%"},modelValue:f.value,"onUpdate:modelValue":t[11]||(t[11]=l=>f.value=l),rows:2,type:"textarea",placeholder:"\u8BF7\u8F93\u5165sql\u8BED\u53E5"},null,8,["modelValue"]),he,e(w,{data:a.sqlData,style:{"margin-left":"50px","margin-top":"20px",width:"90%"}},{default:o(()=>[(p(!0),W(Z,null,Y(a.sqlDataHeader,(l,b)=>(p(),c(r,{"show-overflow-tooltip":!0,width:"100px",prop:b,label:l,key:b},null,8,["prop","label"]))),128))]),_:1},8,["data"])])])]),_:1},8,["modelValue","direction"])])]),e(ee,{ref_key:"addOrUpdateRef",ref:F,onRefreshDataList:s(C)},null,8,["onRefreshDataList"])]),_:1})}}});export{Fe as default};
