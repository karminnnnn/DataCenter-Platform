import{ad as f,d as G,K as H,h as B,X as O,r as p,o as a,f as c,w as l,b as n,c as m,e as P,F as X,a as g,G as r,t as _,a1 as J,l as q,E as W}from"./index.afa5927e.js";import{f as w}from"./folder.ea536bf2.js";import{_ as L}from"./database.235d7a89.js";import{_ as T}from"./table.e1c1b00a.js";import{_ as M}from"./column.79595943.js";import{_ as x}from"./model.45425835.js";import{e as Y,f as Z}from"./metadata.ec7a05f4.js";const ee=d=>f.get("/data-governance/quality-config/"+d),ue=d=>d.id?f.put("/data-governance/quality-config",d):f.post("/data-governance/quality-config",d),te=()=>f.get("/data-governance/quality-rule/list"),Ve=d=>f.put("/data-governance/quality-config/online/"+d),Ie=d=>f.put("/data-governance/quality-config/offline/"+d),ke=d=>f.put("/data-governance/quality-config/hand-run/"+d),ae={key:0,src:w},le={key:1,src:L},re={key:2,src:T},oe={key:3,src:M},ne={key:4,src:x},se={style:{"margin-left":"8px"}},de={key:0,src:w},ie={key:1,src:L},me={key:2,src:T},pe={key:3,src:M},ce={key:4,src:x},ge={style:{"margin-left":"8px"}},fe=q("\u53D6\u6D88"),_e=q("\u786E\u5B9A"),ve=G({__name:"add-or-update",emits:["refreshDataList"],setup(d,{expose:U,emit:S}){H(()=>{te().then(o=>{h.value=o.data}),Y("").then(o=>{A.value=o.data})});const y=B(!1),F=B(),e=O({name:"",categoryId:"",ruleId:"",metadataIds:[],metadataStrs:"",param:{uniqueType:"",columnLength:1,columnMetaId:"",timeLength:1},relMetadataStr:"",taskType:"",cron:"",note:""}),h=B([]),E={label:"name",children:"children",isLeaf:"leaf",disabled:"disabled"},A=B([]),N=(o,u)=>{y.value=!0,e.id="",F.value&&F.value.resetFields(),e.metadataIds=[],e.param={uniqueType:"",columnLength:1,columnMetaId:"",timeLength:1},e.categoryId=u,o&&R(o)},R=o=>{ee(o).then(u=>{Object.assign(e,u.data)})},$=B({name:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],ruleId:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],metadataIds:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],metadataStrs:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],relMetadataStr:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],taskType:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],cron:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],param:{uniqueType:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],columnLength:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],columnMetaId:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],timeLength:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}}),V=()=>{F.value.validate(o=>{if(!o)return!1;if(e.ruleId!=1&&e.ruleId!=7&&e.ruleId!=9&&e.ruleId!=10&&(e.param=null),e.ruleId==9&&!e.id){let u=[];u.push(e.metadataIds),e.metadataIds=u}e.cron=e.taskType==2?e.cron:null,ue(e).then(()=>{W.success({message:"\u64CD\u4F5C\u6210\u529F",duration:500,onClose:()=>{y.value=!1,S("refreshDataList")}})})})},I=async(o,u)=>{if(o.level==0)return u(A.value);if(o.level>=1)if(o.data.children)u(o.data.children);else{const{data:b}=await Z(o.data.id);u(b)}};return U({init:N}),(o,u)=>{const b=p("el-input"),i=p("el-form-item"),K=p("el-option"),Q=p("el-select"),k=p("el-tree-select"),v=p("fast-select"),D=p("el-input-number"),z=p("el-form"),C=p("el-button"),j=p("el-dialog");return a(),c(j,{modelValue:y.value,"onUpdate:modelValue":u[13]||(u[13]=t=>y.value=t),title:e.id?"\u4FEE\u6539":"\u65B0\u589E","close-on-click-modal":!1},{footer:l(()=>[n(C,{onClick:u[11]||(u[11]=t=>y.value=!1)},{default:l(()=>[fe]),_:1}),n(C,{type:"primary",onClick:u[12]||(u[12]=t=>V())},{default:l(()=>[_e]),_:1})]),default:l(()=>[n(z,{ref_key:"dataFormRef",ref:F,model:e,rules:$.value,"label-width":"100px",onKeyup:u[10]||(u[10]=J(t=>V(),["enter"]))},{default:l(()=>[n(i,{label:"\u540D\u79F0",prop:"name","label-width":"auto"},{default:l(()=>[n(b,{modelValue:e.name,"onUpdate:modelValue":u[0]||(u[0]=t=>e.name=t),placeholder:"\u540D\u79F0"},null,8,["modelValue"])]),_:1}),n(i,{label:"\u89C4\u5219\u7C7B\u578B",prop:"ruleId","label-width":"auto"},{default:l(()=>[n(Q,{modelValue:e.ruleId,"onUpdate:modelValue":u[1]||(u[1]=t=>e.ruleId=t),clearable:"",filterable:"",disabled:!!e.id,placeholder:"\u8BF7\u9009\u62E9"},{default:l(()=>[(a(!0),m(X,null,P(h.value,(t,s)=>(a(),c(K,{key:t.id,label:`[${t.engName}]${t.name}`,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),!!e.ruleId&&!e.id?(a(),c(i,{key:0,label:"\u68C0\u6D4B\u5B57\u6BB5",prop:"metadataIds","label-width":"auto"},{default:l(()=>[n(k,{modelValue:e.metadataIds,"onUpdate:modelValue":u[2]||(u[2]=t=>e.metadataIds=t),multiple:e.ruleId!=9,props:E,data:A.value,clearable:"",load:I,lazy:!0},{default:l(({node:t,data:s})=>[g("div",null,[g("span",null,[s.icon=="/src/assets/folder.png"?(a(),m("img",ae)):r("",!0),s.icon=="/src/assets/database.png"?(a(),m("img",le)):r("",!0),s.icon=="/src/assets/table.png"?(a(),m("img",re)):r("",!0),s.icon=="/src/assets/column.png"?(a(),m("img",oe)):r("",!0),s.icon=="/src/assets/model.png"?(a(),m("img",ne)):r("",!0),g("span",se,_(s.name)+"\u2003"+_(s.code),1)])])]),_:1},8,["modelValue","multiple","data"])]),_:1})):r("",!0),!!e.ruleId&&e.id?(a(),c(i,{key:1,label:"\u68C0\u6D4B\u5B57\u6BB5",prop:"metadataStrs","label-width":"auto"},{default:l(()=>[g("span",null,_(e.metadataStrs),1)]),_:1})):r("",!0),e.ruleId==1?(a(),c(i,{key:2,label:"\u5224\u65AD\u65B9\u5F0F",prop:"param.uniqueType","label-width":"auto"},{default:l(()=>[n(v,{modelValue:e.param.uniqueType,"onUpdate:modelValue":u[3]||(u[3]=t=>e.param.uniqueType=t),"dict-type":"quality_unique_type",placeholder:"\u5224\u65AD\u65B9\u5F0F",clearable:""},null,8,["modelValue"])]),_:1})):r("",!0),e.ruleId==7?(a(),c(i,{key:3,label:"\u5B57\u6BB5\u957F\u5EA6",prop:"param.columnLength","label-width":"auto"},{default:l(()=>[n(D,{modelValue:e.param.columnLength,"onUpdate:modelValue":u[4]||(u[4]=t=>e.param.columnLength=t),min:1,max:99999999,placeholder:"\u5B57\u6BB5\u957F\u5EA6"},null,8,["modelValue"])]),_:1})):r("",!0),e.ruleId==9&&!e.id?(a(),c(i,{key:4,label:"\u5173\u8054\u5B57\u6BB5",prop:"param.columnMetaId","label-width":"auto"},{default:l(()=>[n(k,{modelValue:e.param.columnMetaId,"onUpdate:modelValue":u[5]||(u[5]=t=>e.param.columnMetaId=t),props:E,data:A.value,clearable:"",load:I,lazy:!0},{default:l(({node:t,data:s})=>[g("div",null,[g("span",null,[s.icon=="/src/assets/folder.png"?(a(),m("img",de)):r("",!0),s.icon=="/src/assets/database.png"?(a(),m("img",ie)):r("",!0),s.icon=="/src/assets/table.png"?(a(),m("img",me)):r("",!0),s.icon=="/src/assets/column.png"?(a(),m("img",pe)):r("",!0),s.icon=="/src/assets/model.png"?(a(),m("img",ce)):r("",!0),g("span",ge,_(s.name)+"\u2003"+_(s.code),1)])])]),_:1},8,["modelValue","data"])]),_:1})):r("",!0),e.ruleId==9&&e.id?(a(),c(i,{key:5,label:"\u5173\u8054\u5B57\u6BB5",prop:"relMetadataStr","label-width":"auto"},{default:l(()=>[g("span",null,_(e.relMetadataStr),1)]),_:1})):r("",!0),e.ruleId==10?(a(),c(i,{key:6,label:"\u66F4\u65B0\u65F6\u957F(s)",prop:"param.timeLength","label-width":"auto"},{default:l(()=>[n(D,{modelValue:e.param.timeLength,"onUpdate:modelValue":u[6]||(u[6]=t=>e.param.timeLength=t),min:1,max:99999999,placeholder:"\u66F4\u65B0\u65F6\u957F(s)"},null,8,["modelValue"])]),_:1})):r("",!0),n(i,{label:"\u4EFB\u52A1\u7C7B\u578B",prop:"taskType","label-width":"auto"},{default:l(()=>[n(v,{modelValue:e.taskType,"onUpdate:modelValue":u[7]||(u[7]=t=>e.taskType=t),"dict-type":"quality_config_task_type",placeholder:"\u4EFB\u52A1\u7C7B\u578B",clearable:""},null,8,["modelValue"])]),_:1}),e.taskType==2?(a(),c(i,{key:7,label:"cron\u8868\u8FBE\u5F0F",prop:"cron","label-width":"auto"},{default:l(()=>[n(b,{modelValue:e.cron,"onUpdate:modelValue":u[8]||(u[8]=t=>e.cron=t),placeholder:"cron\u8868\u8FBE\u5F0F",clearable:""},null,8,["modelValue"])]),_:1})):r("",!0),n(i,{label:"\u5907\u6CE8",prop:"note","label-width":"auto"},{default:l(()=>[n(b,{type:"textarea",modelValue:e.note,"onUpdate:modelValue":u[9]||(u[9]=t=>e.note=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}});export{ve as _,Ie as a,ke as h,Ve as o};
