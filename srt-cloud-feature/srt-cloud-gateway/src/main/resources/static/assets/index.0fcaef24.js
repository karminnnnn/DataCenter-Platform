import{ad as V,d as I,X as P,h,ai as Q,r as n,aj as W,o as c,c as R,a as m,b as e,w as a,a1 as Y,k as p,a6 as Z,f as x,l as s,t as C,F as N,e as ee,E}from"./index.afa5927e.js";import te from"./info.73e4aea2.js";import{u as ae}from"./access.d3ea15fb.js";import{_ as le}from"./ods-task-detail.vue_vue_type_script_setup_true_name_OdsTaskDetailIndex_lang.2929dbad.js";import"./database.e836db09.js";const ne=i=>V.get("/data-integrate/ods/"+i+"/column-info"),ue=i=>V.get("/data-integrate/ods/"+i+"/table-data"),oe={class:"common-layout"},re=s("\u67E5\u8BE2"),se=s(" \u8868\u5C5E\u6027 "),ie=s("\u67E5\u770B"),de=m("br",null,null,-1),ce=s(" \u5B57\u6BB5\u4FE1\u606F "),pe=m("p",null,"\u82E5\u8D85\u8FC750\u6761\uFF0C\u53EA\u663E\u793A\u524D50\u6761\u6570\u636E\uFF01",-1),me=I({name:"Data-integrateOdsIndex"}),Fe=I({...me,setup(i){const t=P({dataListUrl:"/data-integrate/ods/page",queryForm:{tableName:"",remarks:"",projectId:""},currentRow:{},tableColumns:[],tableData:[],tableDataHeader:{}}),_=h(""),H=()=>{if(!t.currentRow.tableName)return E({message:"\u8BF7\u5728\u5DE6\u4FA7\u9009\u62E9\u8981\u67E5\u770B\u7684\u8868",type:"warning"}),!1},F=h(),L=r=>{r=="tableData"?ue(t.currentRow.tableName).then(l=>{t.tableDataHeader=l.data.columns,t.tableData=l.data.rows}):r=="tableLog"&&F.value.init(t.currentRow.projectId,t.currentRow.tableName)},S=r=>{!r||(_.value="tableInfo",t.currentRow=r,t.tableColumns=[],t.tableData=[],t.tableDataHeader={},ne(r.tableName).then(l=>{t.tableColumns=l.data}))},y=h(),T=()=>{if(!t.currentRow.dataAccessId){E({message:"\u6CA1\u6709\u67E5\u8BE2\u5230\u8BE5\u8868\u5BF9\u5E94\u7684\u6570\u636E\u63A5\u5165\u4EFB\u52A1",type:"warning"});return}ae(t.currentRow.dataAccessId).then(r=>{if(!r.data){E({message:"\u8BE5\u4EFB\u52A1\u5DF2\u88AB\u5220\u9664\uFF0C\u82E5\u8981\u6062\u590D\uFF0C\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458\u5904\u7406",type:"warning"});return}y.value.init(t.currentRow.dataAccessId)})},{getDataList:D,selectionChangeHandle:_e,sizeChangeHandle:j,currentChangeHandle:q,deleteBatchHandle:ge}=Q(t);return(r,l)=>{const A=n("el-input"),g=n("el-form-item"),B=n("el-button"),U=n("el-form"),$=n("fast-table-project-column"),u=n("el-table-column"),f=n("el-table"),K=n("el-pagination"),v=n("el-card"),M=n("el-aside"),w=n("el-tag"),d=n("el-descriptions-item"),O=n("el-descriptions"),b=n("el-tab-pane"),X=n("el-tabs"),G=n("el-header"),k=n("el-container"),J=W("loading");return c(),R(N,null,[m("div",oe,[e(k,null,{default:a(()=>[e(M,{width:"30%"},{default:a(()=>[e(v,{"body-style":"height: calc(100vh - 170px )"},{default:a(()=>[e(U,{inline:!0,model:t.queryForm,onKeyup:l[3]||(l[3]=Y(o=>p(D)(),["enter"]))},{default:a(()=>[e(g,{size:"small"},{default:a(()=>[e(A,{modelValue:t.queryForm.tableName,"onUpdate:modelValue":l[0]||(l[0]=o=>t.queryForm.tableName=o),placeholder:"\u8868\u540D"},null,8,["modelValue"])]),_:1}),e(g,{size:"small"},{default:a(()=>[e(A,{modelValue:t.queryForm.remarks,"onUpdate:modelValue":l[1]||(l[1]=o=>t.queryForm.remarks=o),placeholder:"\u6CE8\u91CA"},null,8,["modelValue"])]),_:1}),e(g,{size:"small"},{default:a(()=>[e(B,{type:"primary",onClick:l[2]||(l[2]=o=>p(D)())},{default:a(()=>[re]),_:1})]),_:1})]),_:1},8,["model"]),Z((c(),x(f,{data:t.dataList,border:"",style:{width:"100%"},"max-height":"calc(100vh - 400px )","highlight-current-row":"",onCurrentChange:S},{default:a(()=>[e($,{prop:"projectId",label:"\u6240\u5C5E\u9879\u76EE","header-align":"center",align:"center"}),e(u,{prop:"tableName",label:"\u8868\u540D","header-align":"center",align:"center"}),e(u,{prop:"remarks",label:"\u6CE8\u91CA","header-align":"center",align:"center"})]),_:1},8,["data"])),[[J,t.dataListLoading]]),e(K,{"current-page":t.page,"page-sizes":t.pageSizes,"page-size":t.limit,total:t.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:p(j),onCurrentChange:p(q)},null,8,["current-page","page-sizes","page-size","total","onSizeChange","onCurrentChange"])]),_:1})]),_:1}),e(k,null,{default:a(()=>[e(G,null,{default:a(()=>[e(v,{"body-style":"height: calc(100vh - 170px )"},{default:a(()=>[e(X,{modelValue:_.value,"onUpdate:modelValue":l[5]||(l[5]=o=>_.value=o),class:"demo-tabs",onTabChange:L,"before-leave":H},{default:a(()=>[e(b,{label:"\u8868\u4FE1\u606F",name:"tableInfo"},{default:a(()=>[e(w,{size:"large",effect:"dark",round:"",style:{"margin-bottom":"15px"}},{default:a(()=>[se]),_:1}),e(O,{column:1,direction:"horizontal",style:{}},{default:a(()=>[e(d,{label:"\u8868\u540D"},{default:a(()=>[s(C(t.currentRow.tableName),1)]),_:1}),e(d,{label:"\u6CE8\u91CA"},{default:a(()=>[s(C(t.currentRow.remarks),1)]),_:1}),e(d,{label:"\u6570\u636E\u63A5\u5165\u4EFB\u52A1"},{default:a(()=>[e(B,{type:"primary",link:"",onClick:l[4]||(l[4]=o=>T())},{default:a(()=>[ie]),_:1})]),_:1}),e(d,{label:"\u6700\u8FD1\u540C\u6B65\u65F6\u95F4"},{default:a(()=>[s(C(t.currentRow.recentlySyncTime?t.currentRow.recentlySyncTime:"\u6682\u65E0"),1)]),_:1})]),_:1}),de,e(w,{size:"large",effect:"dark",round:"",style:{"margin-bottom":"15px"}},{default:a(()=>[ce]),_:1}),e(f,{data:t.tableColumns,height:"400",style:{width:"100%"}},{default:a(()=>[e(u,{prop:"fieldName",label:"\u540D\u79F0","header-align":"center",align:"center"}),e(u,{prop:"remarks",label:"\u6CE8\u91CA","header-align":"center",align:"center"}),e(u,{prop:"fieldTypeName",label:"\u7C7B\u578B","header-align":"center",align:"center"}),e(u,{prop:"displaySize",label:"\u957F\u5EA6","header-align":"center",align:"center"}),e(u,{prop:"scaleSize",label:"\u5C0F\u6570\u4F4D\u6570","header-align":"center",align:"center"}),e(u,{prop:"defaultValue",label:"\u9ED8\u8BA4\u503C","header-align":"center",align:"center"}),e(u,{prop:"pk",label:"\u662F\u5426\u4E3B\u952E","header-align":"center",align:"center"}),e(u,{prop:"autoIncrement",label:"\u662F\u5426\u9012\u589E","header-align":"center",align:"center"}),e(u,{prop:"nullable",label:"\u662F\u5426\u53EF\u4E3A\u7A7A","header-align":"center",align:"center"})]),_:1},8,["data"])]),_:1}),e(b,{label:"\u6570\u636E\u9884\u89C8",name:"tableData"},{default:a(()=>[m("div",null,[pe,e(f,{data:t.tableData,style:{"margin-top":"20px",width:"90%"},height:"600"},{default:a(()=>[(c(!0),R(N,null,ee(t.tableDataHeader,(o,z)=>(c(),x(u,{"show-overflow-tooltip":!0,width:"100px",prop:z,label:o,key:z},null,8,["prop","label"]))),128))]),_:1},8,["data"])])]),_:1}),e(b,{label:"\u63A5\u5165\u65E5\u5FD7",name:"tableLog"},{default:a(()=>[e(le,{ref_key:"odsTaskDetailRef",ref:F},null,512)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),e(te,{ref_key:"infoRef",ref:y},null,512)],64)}}});export{Fe as default};
