import{d as k,h as p,X as I,r,o as b,f as E,w as t,b as l,a1 as q,l as A,al as P,E as F}from"./index.afa5927e.js";import{u as j,f as h,t as S}from"./database.e836db09.js";const T=A("\u53D6\u6D88"),x=A("\u6D4B\u8BD5"),L=A("\u786E\u5B9A"),K=k({__name:"add-or-update",emits:["refreshDataList"],setup($,{expose:V,emit:f}){const n=p(!1),m=p(),D=p([]),u=I({orgId:"",name:"",databaseType:"",databaseIp:"",databasePort:"",databaseName:"",databaseSchema:"",userName:"",password:"",newPassword:"******",jdbcUrl:"",projectId:""}),B=o=>{n.value=!0,u.id="",u.newPassword="******",m.value&&m.value.resetFields(),P().then(e=>{D.value=e.data}),o&&_(o)},C=o=>{u.password=o},_=o=>{j(o).then(e=>{Object.assign(u,e.data)})},v=p({orgId:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],name:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],databaseType:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],databaseIp:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],databasePort:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],databaseName:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],databaseSchema:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],userName:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],password:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),g=()=>{m.value.validate(o=>{if(!o)return!1;h(u).then(()=>{F.success({message:"\u64CD\u4F5C\u6210\u529F",duration:500,onClose:()=>{n.value=!1,f("refreshDataList")}})})})},c=()=>{m.value.validate(o=>{if(!o)return!1;S(u).then(()=>{F.success({message:"\u6D4B\u8BD5\u8FDE\u63A5\u6210\u529F",duration:500,onClose:()=>{f("refreshDataList")}})})})};return V({init:B}),(o,e)=>{const w=r("el-tree-select"),s=r("el-form-item"),d=r("el-input"),y=r("fast-select"),U=r("el-form"),i=r("el-button"),N=r("el-dialog");return b(),E(N,{modelValue:n.value,"onUpdate:modelValue":e[15]||(e[15]=a=>n.value=a),title:u.id?"\u4FEE\u6539":"\u65B0\u589E","close-on-click-modal":!1},{footer:t(()=>[l(i,{onClick:e[12]||(e[12]=a=>n.value=!1)},{default:t(()=>[T]),_:1}),l(i,{type:"primary",onClick:e[13]||(e[13]=a=>c())},{default:t(()=>[x]),_:1}),l(i,{type:"primary",onClick:e[14]||(e[14]=a=>g())},{default:t(()=>[L]),_:1})]),default:t(()=>[l(U,{ref_key:"dataFormRef",ref:m,model:u,rules:v.value,"label-width":"120px",onKeyup:e[11]||(e[11]=q(a=>g(),["enter"]))},{default:t(()=>[l(s,{prop:"orgId",label:"\u6240\u5C5E\u673A\u6784"},{default:t(()=>[l(w,{clearable:"",modelValue:u.orgId,"onUpdate:modelValue":e[0]||(e[0]=a=>u.orgId=a),data:D.value,"check-strictly":"","value-key":"id",props:{label:"name",children:"children"},style:{width:"100%"}},null,8,["modelValue","data"])]),_:1}),l(s,{label:"\u540D\u79F0",prop:"name"},{default:t(()=>[l(d,{modelValue:u.name,"onUpdate:modelValue":e[1]||(e[1]=a=>u.name=a),placeholder:"\u540D\u79F0"},null,8,["modelValue"])]),_:1}),l(s,{label:"\u6570\u636E\u5E93\u7C7B\u578B",prop:"databaseType"},{default:t(()=>[l(y,{modelValue:u.databaseType,"onUpdate:modelValue":e[2]||(e[2]=a=>u.databaseType=a),"dict-type":"database_type",placeholder:"\u8BF7\u9009\u62E9",clearable:""},null,8,["modelValue"])]),_:1}),l(s,{label:"\u4E3B\u673Aip",prop:"databaseIp"},{default:t(()=>[l(d,{modelValue:u.databaseIp,"onUpdate:modelValue":e[3]||(e[3]=a=>u.databaseIp=a),placeholder:"\u4E3B\u673Aip"},null,8,["modelValue"])]),_:1}),l(s,{label:"\u7AEF\u53E3",prop:"databasePort"},{default:t(()=>[l(d,{modelValue:u.databasePort,"onUpdate:modelValue":e[4]||(e[4]=a=>u.databasePort=a),placeholder:"\u7AEF\u53E3"},null,8,["modelValue"])]),_:1}),l(s,{label:"\u5E93\u540D(\u670D\u52A1\u540D)",prop:"databaseName"},{default:t(()=>[l(d,{modelValue:u.databaseName,"onUpdate:modelValue":e[5]||(e[5]=a=>u.databaseName=a),placeholder:"\u5E93\u540D(\u670D\u52A1\u540D)"},null,8,["modelValue"])]),_:1}),l(s,{label:"schema",prop:"databaseSchema"},{default:t(()=>[l(d,{modelValue:u.databaseSchema,"onUpdate:modelValue":e[6]||(e[6]=a=>u.databaseSchema=a),placeholder:"schema"},null,8,["modelValue"])]),_:1}),l(s,{label:"\u7528\u6237\u540D",prop:"userName"},{default:t(()=>[l(d,{modelValue:u.userName,"onUpdate:modelValue":e[7]||(e[7]=a=>u.userName=a),placeholder:"\u7528\u6237\u540D(\u6CE8\u610F\u5927\u5C0F\u5199)"},null,8,["modelValue"])]),_:1}),l(s,{label:"\u5BC6\u7801",prop:"password"},{default:t(()=>[u.id?(b(),E(d,{key:1,modelValue:u.newPassword,"onUpdate:modelValue":e[9]||(e[9]=a=>u.newPassword=a),placeholder:"\u5BC6\u7801",onChange:C},null,8,["modelValue"])):(b(),E(d,{key:0,modelValue:u.password,"onUpdate:modelValue":e[8]||(e[8]=a=>u.password=a),placeholder:"\u5BC6\u7801"},null,8,["modelValue"]))]),_:1}),l(s,{label:"jdbc\u8FDE\u63A5\u4E32",prop:"jdbcUrl"},{default:t(()=>[l(d,{modelValue:u.jdbcUrl,"onUpdate:modelValue":e[10]||(e[10]=a=>u.jdbcUrl=a),placeholder:"jdbc\u8FDE\u63A5\u4E32(\u82E5\u586B\u5199\u5C06\u4EE5\u586B\u5199\u7684\u5185\u5BB9\u8FDE\u63A5,\u5426\u5219\u4F1A\u540E\u53F0\u81EA\u52A8\u6784\u5EFA\u8FDE\u63A5)"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}});export{K as _};
