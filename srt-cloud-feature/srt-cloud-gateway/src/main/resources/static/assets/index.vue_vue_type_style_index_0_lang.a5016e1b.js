import{d as O,K as de,h as g,X as ce,ai as pe,r as d,aj as H,a6 as _,a7 as f,o as u,f as r,w as n,a as B,b as a,G as k,c as _e,e as fe,F as me,k as F,a1 as he,l as i,t as ge,n as ye,E,a8 as N}from"./index.afa5927e.js";import{_ as ve}from"./add-or-update.vue_vue_type_script_setup_true_lang.70c7e6f1.js";import{_ as Fe}from"./app-info.vue_vue_type_script_setup_true_lang.883f96fa.js";import{_ as Ce}from"./api-test.vue_vue_type_script_setup_true_lang.a98e6589.js";import{c as ke}from"./database.e836db09.js";import{o as we,b as be,i as Be}from"./apiConfig.3f64c346.js";import{g as Ee,c as De}from"./app.6975e7a0.js";import{_ as Ae}from"./api-auth.vue_vue_type_script_setup_true_lang.14159bc7.js";import{_ as qe}from"./api-auth-detail.vue_vue_type_script_setup_true_lang.9b1c66b9.js";const Ie=i("\u67E5\u8BE2"),Te=i("\u67E5\u8BE2"),Ve=i("\u65B0\u589E"),$e=i("\u5BFC\u51FA\u6587\u6863"),xe=i("\u672A\u53D1\u5E03"),Le=i("\u5DF2\u53D1\u5E03"),Re=i("\u67E5\u770B"),Ue=i("\u6388\u6743"),Se=i("\u4FEE\u6539\u6388\u6743"),ze=i("\u53D6\u6D88\u6388\u6743"),He=i("\u4E0A\u7EBF"),Ne=i("\u6D4B\u8BD5"),Oe=i("\u4E0B\u7EBF"),Me=i("\u4FEE\u6539"),Pe=i("\u5220\u9664"),Ke={class:"drawerClass",style:{height:"100%"}},je={class:"drawerClass",style:{height:"100%"}},Ge={class:"drawerClass",style:{height:"100%"}},Xe=O({name:"Data-serviceApi-configIndex"}),ot=O({...Xe,setup(Je,{expose:M}){de(()=>{P()});const I=g(!1);g([]);const P=()=>{ke().then(o=>{l.databaseList=o.data})},l=ce({createdIsNeed:!1,databaseList:[],dataListUrl:"/data-service/api-config/page",deleteUrl:"/data-service/api-config",path:"",queryForm:{groupId:"",name:"",path:"",contentType:"",status:"",sqlDbType:"",databaseId:"",previlege:"",openTrans:""}}),D=g(),s=g(!1),m=g(!1),K=(o,t,b,c,w)=>{l.queryForm.groupId=o,l.path=t,D.value=b||0,l.queryForm.appId=D.value,s.value=c||!1,m.value=w||!1,m.value&&(l.queryForm.ifMarket=1),s.value&&(l.dataListUrl="/data-service/api-config/page-auth"),y(),I.value=!0},T=g(),V=o=>{T.value.init(o,l.queryForm.groupId)},$=g(),j=(o,t)=>{$.value.init(o,t)},G=o=>{we(o).then(t=>{E.success("\u4E0A\u7EBF\u6210\u529F"),y()})},X=o=>{N.confirm("\u786E\u5B9A\u4E0B\u7EBF\u5417?","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{be(o).then(t=>{E.success("\u4E0B\u7EBF\u6210\u529F"),y()})}).catch(()=>{})},x=g(),J=o=>{x.value.init(o)},L=g(),Q=o=>{const t={appId:D.value,groupId:l.queryForm.groupId,apiId:o};L.value.init(t)},R=g(),W=o=>{Ee(o).then(t=>{R.value.init(t.data)})},Y=o=>{N.confirm("\u786E\u5B9A\u53D6\u6D88\u6388\u6743\u5417?","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{De(o).then(t=>{E.success("\u53D6\u6D88\u6388\u6743\u6210\u529F"),y()})}).catch(()=>{})},Z=async()=>{let o=l.dataListSelections?l.dataListSelections:[];if(o.length===0){E.warning("\u8BF7\u52FE\u9009\u9700\u8981\u5BFC\u51FA\u7684api");return}const{data:t}=await Be();await ne("http://"+t+"/data-service/api-config/export-docs","API DOCS.md","POST",o)},{getDataList:y,selectionChangeHandle:ee,sizeChangeHandle:te,currentChangeHandle:ae,deleteBatchHandle:le,downloadHandle:ne}=pe(l);return M({init:K}),(o,t)=>{const b=d("el-input"),c=d("el-form-item"),w=d("fast-select"),A=d("el-option"),U=d("el-select"),p=d("el-button"),oe=d("el-form"),h=d("el-table-column"),q=d("fast-table-column"),S=d("el-tag"),z=d("fast-creator-column"),ue=d("el-table"),re=d("el-pagination"),ie=d("el-card"),C=H("auth"),se=H("loading");return _((u(),r(ie,null,{default:n(()=>[B("div",{class:ye(s.value?"apiConfigAuthDivClass":"apiConfigDivClass")},[a(oe,{inline:!0,model:l.queryForm,onKeyup:t[11]||(t[11]=he(e=>F(y)(),["enter"]))},{default:n(()=>[a(c,null,{default:n(()=>[a(b,{modelValue:l.queryForm.name,"onUpdate:modelValue":t[0]||(t[0]=e=>l.queryForm.name=e),placeholder:"\u540D\u79F0"},null,8,["modelValue"])]),_:1}),a(c,null,{default:n(()=>[a(w,{modelValue:l.queryForm.contentType,"onUpdate:modelValue":t[1]||(t[1]=e=>l.queryForm.contentType=e),"dict-type":"content_type",placeholder:"\u5185\u5BB9\u7C7B\u578B",clearable:"",filterable:""},null,8,["modelValue"])]),_:1}),a(c,null,{default:n(()=>[a(w,{modelValue:l.queryForm.status,"onUpdate:modelValue":t[2]||(t[2]=e=>l.queryForm.status=e),"dict-type":"release_status",placeholder:"\u72B6\u6001",clearable:"",filterable:""},null,8,["modelValue"])]),_:1}),m.value?k("",!0):(u(),r(c,{key:0},{default:n(()=>[a(U,{modelValue:l.queryForm.sqlDbType,"onUpdate:modelValue":t[3]||(t[3]=e=>l.queryForm.sqlDbType=e),clearable:"",filterable:"",placeholder:"sql\u5E93\u7C7B\u578B"},{default:n(()=>[(u(),r(A,{key:1,label:"\u6570\u636E\u5E93",value:1})),(u(),r(A,{key:2,label:"\u4E2D\u53F0\u5E93",value:2}))]),_:1},8,["modelValue"])]),_:1})),m.value?k("",!0):(u(),r(c,{key:1},{default:n(()=>[a(U,{modelValue:l.queryForm.databaseId,"onUpdate:modelValue":t[4]||(t[4]=e=>l.queryForm.databaseId=e),clearable:"",filterable:"",placeholder:"\u6570\u636E\u5E93"},{default:n(()=>[(u(!0),_e(me,null,fe(l.databaseList,(e,v)=>(u(),r(A,{key:e.id,label:`[${e.id}]${e.name}`,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})),m.value?k("",!0):(u(),r(c,{key:2},{default:n(()=>[a(w,{modelValue:l.queryForm.previlege,"onUpdate:modelValue":t[5]||(t[5]=e=>l.queryForm.previlege=e),"dict-type":"yes_or_no",placeholder:"\u662F\u5426\u79C1\u6709",clearable:"",filterable:""},null,8,["modelValue"])]),_:1})),a(c,null,{default:n(()=>[a(w,{modelValue:l.queryForm.openTrans,"onUpdate:modelValue":t[6]||(t[6]=e=>l.queryForm.openTrans=e),"dict-type":"yes_or_no",placeholder:"\u5F00\u542F\u4E8B\u52A1",clearable:"",filterable:""},null,8,["modelValue"])]),_:1}),a(c,null,{default:n(()=>[s.value?(u(),r(p,{key:0,onClick:t[7]||(t[7]=e=>F(y)()),type:"primary"},{default:n(()=>[Ie]),_:1})):(u(),r(p,{key:1,onClick:t[8]||(t[8]=e=>F(y)())},{default:n(()=>[Te]),_:1}))]),_:1}),a(c,null,{default:n(()=>[s.value?k("",!0):_((u(),r(p,{key:0,type:"primary",onClick:t[9]||(t[9]=e=>V())},{default:n(()=>[Ve]),_:1})),[[C,"data-service:api-config:save"]])]),_:1}),s.value?k("",!0):(u(),r(c,{key:3},{default:n(()=>[a(p,{type:"warning",onClick:t[10]||(t[10]=e=>Z())},{default:n(()=>[$e]),_:1})]),_:1}))]),_:1},8,["model"]),_((u(),r(ue,{data:l.dataList,border:"",style:{width:"100%"},"max-height":"calc(100vh - 400px )",onSelectionChange:F(ee)},{default:n(()=>[s.value?k("",!0):(u(),r(h,{key:0,type:"selection","header-align":"center",align:"center",width:"50"})),m.value?k("",!0):(u(),r(h,{key:1,"show-overflow-tooltip":"",label:"\u5206\u7EC4","header-align":"center",align:"center",width:"150"},{default:n(()=>[i(ge(l.path),1)]),_:1})),m.value?(u(),r(h,{key:2,prop:"groupPath","show-overflow-tooltip":"",label:"\u5206\u7EC4","header-align":"center",align:"center",width:"150"})):k("",!0),a(h,{prop:"path","show-overflow-tooltip":"",label:"api\u5730\u5740","header-align":"center",align:"center"}),a(h,{"show-overflow-tooltip":"",prop:"name",label:"\u540D\u79F0","header-align":"center",align:"center"}),a(q,{prop:"contentType",label:"\u5185\u5BB9\u7C7B\u578B","dict-type":"content_type",width:"150","header-align":"center",align:"center"}),a(h,{prop:"status",label:"\u72B6\u6001","header-align":"center",align:"center"},{default:n(e=>[_(a(S,{type:"info"},{default:n(()=>[xe]),_:2},1536),[[f,e.row.status==0]]),_(a(S,{type:"success"},{default:n(()=>[Le]),_:2},1536),[[f,e.row.status==1]])]),_:1}),a(q,{prop:"previlege",label:"\u79C1\u6709","dict-type":"yes_or_no","header-align":"center",align:"center"}),a(q,{prop:"openTrans",label:"\u5F00\u542F\u4E8B\u52A1","dict-type":"yes_or_no","header-align":"center",align:"center"}),a(z,{prop:"releaseUserId",label:"\u53D1\u5E03\u8005","header-align":"center",align:"center"}),a(h,{"show-overflow-tooltip":"",prop:"releaseTime",label:"\u53D1\u5E03\u65F6\u95F4","header-align":"center",align:"center"}),a(z,{prop:"creator",label:"\u521B\u5EFA\u8005","header-align":"center",align:"center"}),a(h,{"show-overflow-tooltip":"",prop:"createTime",label:"\u521B\u5EFA\u65F6\u95F4","header-align":"center",align:"center"}),a(h,{"show-overflow-tooltip":"",prop:"updateTime",label:"\u66F4\u65B0\u65F6\u95F4","header-align":"center",align:"center"}),a(h,{label:"\u64CD\u4F5C",fixed:"right","header-align":"center",align:"center",width:"260"},{default:n(e=>[a(p,{type:"primary",link:"",onClick:v=>j(e.row.id,e.row.authId)},{default:n(()=>[Re]),_:2},1032,["onClick"]),_((u(),r(p,{type:"primary",link:"",onClick:v=>Q(e.row.id)},{default:n(()=>[Ue]),_:2},1032,["onClick"])),[[C,"data-service:app:auth"],[f,s.value&&e.row.authId==null&&!m.value]]),_((u(),r(p,{type:"primary",link:"",onClick:v=>W(e.row.authId)},{default:n(()=>[Se]),_:2},1032,["onClick"])),[[C,"data-service:app:auth"],[f,s.value&&e.row.authId!=null&&!m.value]]),_((u(),r(p,{type:"primary",link:"",onClick:v=>Y(e.row.authId)},{default:n(()=>[ze]),_:2},1032,["onClick"])),[[C,"data-service:app:cancel-auth"],[f,s.value&&e.row.authId!=null&&!m.value]]),_((u(),r(p,{type:"primary",link:"",onClick:v=>G(e.row.id)},{default:n(()=>[He]),_:2},1032,["onClick"])),[[C,"data-service:api-config:online"],[f,e.row.status==0&&!s.value]]),_(a(p,{type:"primary",link:"",onClick:v=>J(e.row)},{default:n(()=>[Ne]),_:2},1032,["onClick"]),[[f,e.row.status==1]]),_((u(),r(p,{type:"primary",link:"",onClick:v=>X(e.row.id)},{default:n(()=>[Oe]),_:2},1032,["onClick"])),[[C,"data-service:api-config:offline"],[f,e.row.status==1&&!s.value]]),_((u(),r(p,{type:"primary",link:"",onClick:v=>V(e.row.id)},{default:n(()=>[Me]),_:2},1032,["onClick"])),[[C,"data-service:api-config:update"],[f,!s.value]]),_((u(),r(p,{type:"primary",link:"",onClick:v=>F(le)(e.row.id)},{default:n(()=>[Pe]),_:2},1032,["onClick"])),[[C,"data-service:api-config:delete"],[f,e.row.status==0&&!s.value]])]),_:1})]),_:1},8,["data","onSelectionChange"])),[[se,l.dataListLoading]]),a(re,{"current-page":l.page,"page-sizes":l.pageSizes,"page-size":l.limit,total:l.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:F(te),onCurrentChange:F(ae)},null,8,["current-page","page-sizes","page-size","total","onSizeChange","onCurrentChange"]),B("div",Ke,[a(ve,{ref_key:"addOrUpdateRef",ref:T,onRefreshDataList:F(y)},null,8,["onRefreshDataList"])]),B("div",je,[a(Fe,{ref_key:"appInfoRef",ref:$},null,512)]),B("div",Ge,[a(Ce,{ref_key:"apiTestRef",ref:x},null,512)]),a(Ae,{ref_key:"apiAuthRef",ref:L,onRefreshAuthList:F(y)},null,8,["onRefreshAuthList"]),a(qe,{ref_key:"apiAuthDetailRef",ref:R},null,512)],2)]),_:1},512)),[[f,I.value]])}}});export{ot as _};
