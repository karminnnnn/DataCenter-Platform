import{d as le,aa as f,h as p,O as ae,X as oe,r as n,o as q,c as ne,b as e,w as a,a as u,k as m,ab as se,a6 as y,a7 as T,t as d,l as i,ac as O,s as X,f as ue,G as ie,v as re}from"./index.afa5927e.js";import{l as de,g as ce}from"./database.e836db09.js";import{_ as pe}from"./database.235d7a89.js";import{_ as _e}from"./table.e1c1b00a.js";import{_ as j}from"./readonly-studio.vue_vue_type_script_setup_true_lang.c5082512.js";const be=u("br",null,null,-1),fe=u("br",null,null,-1),me={class:"custom-tree-node"},he=["src"],ge=["src"],Ce={style:{"margin-left":"8px"}},ve=i("******"),Ee=i("******"),De={class:"custom-tabs-label"},Le=u("span",null,"\u5B57\u6BB5\u4FE1\u606F",-1),xe={class:"custom-tabs-label"},Se=u("span",null,"SQL \u751F\u6210",-1),ye=i("\u67E5\u770B"),Te=i("\u65B0\u5EFA\u67E5\u8BE2"),Re=le({__name:"db",emits:["setCodeText"],setup(Be,{expose:Y,emit:B}){const E=f("editorValues"),V=f("editableTabsValue"),k=f("editableTabs");f("consoleLogRef"),f("consoleResultRef");const g=f("filterNodeText"),w=p(),D=p(!1),L=p(!1),c=p({}),F=p([]),N=p(),R=p();ae(g,l=>{w.value.filter(l)});const A=p([]),o=oe({optionCardShow:!1,optionCardX:0,optionCardY:0,optionData:{},node:"",tree:""}),G=(l,t)=>{A.value=t},P=(l,t)=>l?t.label.includes(l)||t.label.includes(l.toUpperCase())||t.label.includes(l.toLowerCase())||t.description&&t.description.includes(l)||t.description&&t.description.includes(l.toUpperCase())||t.description&&t.description.includes(l.toLowerCase()):!0,$=()=>{let l=o.optionData;console.log(l),x(),l.ifLeaf?(c.value=l.attributes,D.value=!0):(L.value=!0,de(l.parentId,l.label).then(t=>{F.value=t.data}),ce(l.parentId,l.label,l.description).then(t=>{N.value.setEditorValue(t.data.sqlCreate),R.value.setEditorValue(t.data.sqlSelect)}))},H=()=>{K(o.optionData)},J=f("currentNodeData"),K=l=>{J.value=l;let t=l.id+"";const h=k.value;let _=!1;for(let S in h){let s=h[S];if(s.name==t){_=!0,s.title=l.name;break}}_?(V.value=t,B("setCodeText")):(k.value.push({title:l.name,name:t}),V.value=t,B("setCodeText")),_||(E[t]={},E[t].codeText=""),E[t].nodeData=l},M=(l,t,h,_)=>{o.optionCardShow=!1,o.optionCardX=l.x,o.optionCardY=l.y,o.optionData=t,o.node=h,o.tree=_,o.optionCardShow=!0},x=l=>{var t=document.getElementById("option-button-group");t&&(o.optionCardShow=!1)};return Y({init:G,OptionCardClose:x}),(l,t)=>{const h=n("el-input"),_=n("el-tree"),S=n("el-scrollbar"),s=n("el-descriptions-item"),W=n("el-descriptions"),I=n("el-dialog"),Z=n("Document"),Q=n("el-icon"),r=n("el-table-column"),ee=n("el-table"),C=n("el-tab-pane"),te=n("DataLine"),z=n("el-tabs"),U=n("el-button");return q(),ne("div",null,[e(S,null,{default:a(()=>[u("div",{class:"databases",onClick:t[1]||(t[1]=b=>x())},[e(h,{modelValue:m(g),"onUpdate:modelValue":t[0]||(t[0]=b=>se(g)?g.value=b:null),placeholder:"search"},null,8,["modelValue"]),be,fe,e(_,{ref_key:"databaseTreeRef",ref:w,data:A.value,"default-expand-all":"",onNodeContextmenu:M,"node-key":"id","filter-node-method":P},{default:a(({node:b,data:v})=>[u("span",me,[y(u("img",{src:m(pe)},null,8,he),[[T,v.ifLeaf=="1"]]),y(u("img",{src:m(_e)},null,8,ge),[[T,v.ifLeaf=="0"]]),u("span",Ce,d(v.label)+"\u2003"+d(v.description),1)])]),_:1},8,["data"])])]),_:1}),e(I,{modelValue:D.value,"onUpdate:modelValue":t[2]||(t[2]=b=>D.value=b),title:"\u8BE6\u60C5"},{default:a(()=>[e(W,{size:"default",column:1,"label-class-name":"el-descriptions-item-label-class",border:""},{default:a(()=>[e(s,{label:"\u540D\u79F0"},{default:a(()=>[i(d(c.value.name),1)]),_:1}),e(s,{label:"\u6570\u636E\u5E93\u7C7B\u578B"},{default:a(()=>[i(d(m(O)(m(X).appStore.dictList,"database_type",c.value.databaseType)),1)]),_:1}),e(s,{label:"\u5E93\u540D"},{default:a(()=>[i(d(c.value.databaseName),1)]),_:1}),e(s,{label:"IP\u5730\u5740"},{default:a(()=>[i(d(c.value.databaseIp),1)]),_:1}),e(s,{label:"\u7AEF\u53E3"},{default:a(()=>[i(d(c.value.databasePort),1)]),_:1}),e(s,{label:"\u72B6\u6001"},{default:a(()=>[i(d(m(O)(m(X).appStore.dictList,"database_status",c.value.status)),1)]),_:1}),e(s,{label:"\u7528\u6237\u540D"},{default:a(()=>[ve]),_:1}),e(s,{label:"\u5BC6\u7801"},{default:a(()=>[Ee]),_:1}),e(s,{label:"jdbc\u8FDE\u63A5\u4E32"},{default:a(()=>[i(d(c.value.jdbcUrl),1)]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(I,{modelValue:L.value,"onUpdate:modelValue":t[3]||(t[3]=b=>L.value=b),title:"\u8BE6\u60C5",width:"65%"},{default:a(()=>[e(z,{class:"table-tabs"},{default:a(()=>[e(C,null,{label:a(()=>[u("span",De,[e(Q,null,{default:a(()=>[e(Z)]),_:1}),Le])]),default:a(()=>[e(ee,{data:F.value,height:"500",style:{width:"100%"}},{default:a(()=>[e(r,{prop:"fieldName",label:"\u540D\u79F0","header-align":"center",align:"center"}),e(r,{prop:"remarks",label:"\u6CE8\u91CA","header-align":"center",align:"center"}),e(r,{prop:"fieldTypeName",label:"\u7C7B\u578B","header-align":"center",align:"center"}),e(r,{prop:"displaySize",label:"\u957F\u5EA6","header-align":"center",align:"center"}),e(r,{prop:"scaleSize",label:"\u5C0F\u6570\u4F4D\u6570","header-align":"center",align:"center"}),e(r,{prop:"defaultValue",label:"\u9ED8\u8BA4\u503C","header-align":"center",align:"center"}),e(r,{prop:"pk",label:"\u662F\u5426\u4E3B\u952E","header-align":"center",align:"center"}),e(r,{prop:"autoIncrement",label:"\u662F\u5426\u9012\u589E","header-align":"center",align:"center"}),e(r,{prop:"nullable",label:"\u662F\u5426\u53EF\u4E3A\u7A7A","header-align":"center",align:"center"})]),_:1},8,["data"])]),_:1}),e(C,null,{label:a(()=>[u("span",xe,[e(Q,null,{default:a(()=>[e(te)]),_:1}),Se])]),default:a(()=>[e(z,{"tab-position":"left",style:{height:"500px"},class:"sql-tabs"},{default:a(()=>[e(C,{label:"SQL DDL"},{default:a(()=>[e(j,{id:"SQLDDL",ref_key:"SQLDDLRef",ref:N,style:{height:"500px","font-size":"16px"}},null,512)]),_:1}),e(C,{label:"SQL SELECT"},{default:a(()=>[e(j,{id:"SQLSELECT",ref_key:"SQLSELECTRef",ref:R,style:{height:"500px","font-size":"16px"}},null,512)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),y(u("div",{style:re({"z-index":9999,position:"fixed",left:o.optionCardX+"px",top:o.optionCardY+"px",width:"100px",background:"white","box-shadow":"0 2px 4px rgba(0, 0, 0, .12), 0 0 6px rgba(0, 0, 0, .04)"}),id:"option-button-group"},[e(U,{onClick:$,class:"option-card-button"},{default:a(()=>[ye]),_:1}),o.optionData.ifLeaf==1?(q(),ue(U,{key:0,onClick:H,class:"option-card-button"},{default:a(()=>[Te]),_:1})):ie("",!0)],4),[[T,o.optionCardShow]])])}}});export{Re as _};
