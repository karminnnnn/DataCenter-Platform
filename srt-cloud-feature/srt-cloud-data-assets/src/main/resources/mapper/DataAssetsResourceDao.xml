<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="net.srt.dao.DataAssetsResourceDao">


    <select id="getMarketList" resultType="net.srt.entity.DataAssetsResourceEntity">
        SELECT * FROM data_assets_resource WHERE deleted=0 AND status=1
        AND (
         open_type=1
         OR (open_type=2 AND id IN (SELECT resource_id FROM data_assets_resource_open WHERE open_type=2 AND open_id IN(SELECT role_id FROM sys_user_role WHERE user_id=#{userId})))
         OR (open_type=3 AND id IN (SELECT resource_id FROM data_assets_resource_open WHERE open_type=3 AND open_id=#{userId}))
        )
        <if test="catalogId != null">
            AND catalog_id=#{catalogId}
        </if>
        <if test="name != null and name.trim() != ''">
            AND name LIKE "%"#{name}"%"
        </if>
        <if test="code != null and code.trim() != ''">
            AND code LIKE "%"#{code}"%"
        </if>
        <if test="status != null">
            AND status=#{status}
        </if>
        <if test="mountStatus != null">
            AND mount_status=#{mountStatus}
        </if>
        <if test="dutyUser != null and dutyUser.trim() != ''">
            AND duty_user LIKE "%"#{dutyUser}"%"
        </if>
        ORDER BY id DESC
    </select>
</mapper>
